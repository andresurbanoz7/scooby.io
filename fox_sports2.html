<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Reproductor Autorecargable</title>
  <script src="https://cdn.jsdelivr.net/npm/@clappr/player@0.8/dist/clappr.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/p2p-engine.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/clappr-p2p-plugin.min.js"></script>
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: black; }
    #player { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
  </style>
</head>
<body>
  <div id="player"></div>
  <script>
    var qy = [[136,"dHE2OTIwNjZqTg=="],[49,"eWI2OTIxNDhBQQ=="],[146,"VFA2OTIwODN1VQ=="],[140,"dHc2OTIwNzdXdw=="],[125,"cmo2OTIwNzN2UA=="],[28,"dXM2OTIxMjlpTA=="],[0,"RVc2OTIxMzJCYw=="],[120,"anE2OTIwODFDQQ=="],[111,"ZWc2OTIwNzNtVQ=="],[6,"WXg2OTIwNzVuWA=="],[72,"Rng2OTIxMjhTbw=="],[93,"Ym42OTIxMjhDRw=="],[81,"SGs2OTIwODNCaQ=="],[59,"cE82OTIwNzRFQw=="],[100,"REo2OTIxMjZHWg=="],[87,"YWg2OTIwODN6Uw=="],[95,"bEg2OTIwODVXVw=="],[70,"YUQ2OTIwODlNRg=="],[126,"anM2OTIwNzd4dg=="],[138,"aEI2OTIxNDBQZQ=="],[96,"Y2U2OTIxMjluYw=="],[82,"dWM2OTIwODJQcg=="],[57,"T3Y2OTIxMjlabQ=="],[7,"ZFE2OTIwNzVsVw=="],[137,"V3c2OTIxMzNSUg=="],[148,"QmU2OTIwNzhQUw=="],[115,"Z2s2OTIwNzdMTw=="],[130,"cmg2OTIwODNpUw=="],[40,"dlI2OTIxMzFaRQ=="],[34,"V3g2OTIxMzdHSw=="],[35,"TnE2OTIwODZXdQ=="],[4,"dnE2OTIxNDNJYQ=="],[114,"T1E2OTIwNzNEag=="],[15,"WEU2OTIxMjVJdg=="],[112,"YkI2OTIwNzZVbg=="],[1,"c1I2OTIxNDRxSA=="],[139,"cFY2OTIwODltZQ=="],[91,"RXM2OTIwODFqcQ=="],[42,"VHY2OTIxMzl4TA=="],[101,"YUU2OTIwNzZ3Vw=="],[69,"TEo2OTIxMzhZZg=="],[44,"ekU2OTIxMjVPcA=="],[67,"WWI2OTIxMzVWTQ=="],[103,"T3o2OTIxMjZCcw=="],[55,"akQ2OTIxMzhuRg=="],[122,"c2g2OTIwNzdPUA=="],[17,"SXI2OTIxMzVwTQ=="],[108,"Y042OTIxMjdUYg=="],[38,"Q282OTIwNzlWcA=="],[104,"RGk2OTIwODJXSg=="],[29,"eXc2OTIxMzJWaA=="],[86,"Y0s2OTIwNzl2cQ=="],[98,"dEk2OTIwODRWSQ=="],[128,"dHQ2OTIwODBMSA=="],[19,"SUE2OTIxNDRMTg=="],[83,"VG42OTIwNzl6SA=="],[60,"TUc2OTIxMzdwdg=="],[144,"UFg2OTIwNzdXUg=="],[123,"ZFY2OTIwNzlGSA=="],[9,"b202OTIxMzlNUg=="],[37,"YlY2OTIwODBETQ=="],[39,"dWk2OTIwNzV3Zw=="],[24,"bW42OTIxNDNFcQ=="],[65,"RkU2OTIxNDRRSQ=="],[36,"TEQ2OTIwODBTUA=="],[2,"Q2k2OTIxNDR5TA=="],[132,"aXY2OTIwODNrdQ=="],[31,"dUE2OTIwNzRuRA=="],[80,"Wms2OTIxMjVzVQ=="],[45,"SEI2OTIxMzZOSA=="],[58,"akE2OTIxNDhWcA=="],[53,"ZEw2OTIwNzVFTQ=="],[116,"b1I2OTIwODNGaw=="],[12,"RXY2OTIwNzROSg=="],[118,"WUI2OTIwODJqRQ=="],[77,"a042OTIwODRCdg=="],[113,"dVk2OTIxMjlQaQ=="],[25,"aE82OTIxMzZERw=="],[54,"Z3g2OTIxMzNJVg=="],[47,"bVc2OTIxMzBlRg=="],[106,"UXU2OTIxMzBaTA=="],[56,"UVE2OTIxMjhQaw=="],[64,"T082OTIwOTFtRg=="],[88,"TGo2OTIwNzdOZA=="],[110,"Vmg2OTIwNzlFSQ=="],[22,"VEs2OTIxMjVLUw=="],[121,"UWs2OTIwNzZTRQ=="],[46,"dHM2OTIwNzVZbA=="],[90,"WEM2OTIxMjZQbw=="],[5,"WFI2OTIwODZMbw=="],[141,"c2Y2OTIwODVLVQ=="],[84,"WE42OTIwODRTYw=="],[68,"bHE2OTIxMjlzaQ=="],[129,"aVI2OTIwODJ6dw=="],[149,"cHY2OTIwODBBeA=="],[13,"Y1c2OTIxMjd1aQ=="],[41,"elA2OTIxMzZJVQ=="],[78,"UW82OTIwODNuRg=="],[119,"WXg2OTIwODNURA=="],[10,"cHo2OTIxMjd1Zg=="],[79,"cG82OTIwODJwdA=="],[71,"Smk2OTIwNzZITA=="],[62,"Tk02OTIxNDVUbw=="],[154,"cHU2OTIwODVCbQ=="],[76,"amg2OTIxMjZzcA=="],[63,"VUo2OTIwODRhdg=="],[52,"Q2g2OTIxNDJIWA=="],[32,"dHY2OTIxMjdCZA=="],[3,"R0s2OTIxNDBMVg=="],[92,"RHI2OTIwNzltbQ=="],[134,"WVE2OTIwNzlPcA=="],[18,"dkw2OTIxNDNXWA=="],[153,"ekU2OTIwODBOQQ=="],[33,"Y0g2OTIxMzl6TQ=="],[50,"amo2OTIwNzh5Rw=="],[109,"WWk2OTIwNzlpVA=="],[97,"S0U2OTIwODRHdQ=="],[94,"RUY2OTIwODRoag=="],[89,"c2g2OTIwNzdmUw=="],[75,"eU42OTIwNzZhVg=="],[147,"Zng2OTIwNzRldw=="],[150,"bnA2OTIwNzhZZw=="],[151,"Q0o2OTIwNzRTZw=="],[124,"aWM2OTIwODVGUg=="],[8,"Y3M2OTIxMjhmWQ=="],[23,"TmY2OTIxMzdyaQ=="],[107,"Smg2OTIwODBsUw=="],[48,"bEo2OTIxMzlYQw=="],[74,"UlM2OTIwODBpdQ=="],[61,"TFQ2OTIwNzlSTg=="],[152,"bWs2OTIwNzd3WA=="],[99,"ZlU2OTIxMjZsYQ=="],[27,"TmQ2OTIxNDZobg=="],[20,"eUw2OTIxNDJsYw=="],[131,"RGw2OTIwNzdsVQ=="],[102,"S1Y2OTIwNzdUdw=="],[133,"b002OTIwODNrRw=="],[73,"QVQ2OTIwODBvRw=="],[142,"d3E2OTIwNzdGSA=="],[14,"Z0M2OTIxNDJlZA=="],[11,"Z2Y2OTIwNzdLRA=="],[85,"a2E2OTIxMzBzTQ=="],[143,"alY2OTIwNzRJSg=="],[16,"V1A2OTIxMjdVdg=="],[135,"cVc2OTIwODVuVQ=="],[43,"d3o2OTIxMjZ4bQ=="],[26,"UFM2OTIxMzNKbw=="],[117,"TFM2OTIwODBIaw=="],[66,"QU82OTIxMzlLVg=="],[127,"bnk2OTIwODN3RA=="],[105,"dnA2OTIwNzZHWg=="],[30,"SmE2OTIxMjhYbQ=="],[21,"eEQ2OTIxMjlhTg=="],[145,"TXc2OTIwNzhzUw=="],[51,"a2o2OTIxMjVVWQ=="]];
    qy.sort((a, b) => a[0] - b[0]);

    function kNMvt() { return 69369; }
    function mysft() { return 622659; }

    let currentPlayer = null;

    function generarPlaybackURL() {
      const k = kNMvt() + mysft(); // 692028
      let url = '';
      for (const e of qy) {
        const v = e[1];
        url += String.fromCharCode(parseInt(atob(v).replace(/\D/g, '')) - k);
      }
      return url;
    }

    function reproducir() {
      const playbackURL = generarPlaybackURL();
      if (!playbackURL || playbackURL.length < 20 || !playbackURL.includes("http")) {
        console.warn("URL invÃ¡lida");
        return false;
      }

      const p2pConfig = { trackerZone: 'us', sourceUrl: playbackURL };
      P2PEngineHls.tryRegisterServiceWorker(p2pConfig).then(() => {
        if (currentPlayer) currentPlayer.destroy();
        currentPlayer = new Clappr.Player({
          source: playbackURL,
          parentId: "#player",
          plugins: [SwarmCloudClapprPlugin],
          width: "100%",
          height: "100%",
          autoPlay: true,
          mute: false,
          playsinline: true,
          playback: {
            hlsjsConfig: {
              maxBufferSize: 0,
              maxBufferLength: 12,
              liveSyncDurationCount: 3,
              p2pConfig: p2pConfig
            }
          }
        });
        window.player = currentPlayer;
      });

      return true;
    }

    function iniciarVerificacion() {
      setInterval(() => {
        if (!currentPlayer) return;
        const estado = currentPlayer.getPlayback()?.getState?.();
        if (["IDLE", "STOPPED", "ERROR"].includes(estado)) {
          console.warn("Stream detenido. Recargando...");
          reproducir();
        }
      }, 30000); // cada 30 segundos
    }

    reproducir();
    iniciarVerificacion();
  </script>
</body>
</html>
