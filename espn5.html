
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reproductor con Recarga Automática</title>
  <script src="https://cdn.jsdelivr.net/npm/@clappr/player@0.8/dist/clappr.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/p2p-engine.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/clappr-p2p-plugin.min.js"></script>
  <style>
    html, body { margin: 0; padding: 0; width: 100%; height: 100%; background: black; }
    #player { width: 100%; height: 100%; position: absolute; top: 0; left: 0; }
  </style>
</head>
<body>
  <div id="player"></div>
  <script>
    var playbackURL = "", Uc = [[79,"RW02NTU2NjNZUA=="],[67,"b3A2NTU3MTdHeg=="],[36,"elc2NTU2NjhVTA=="],[145,"UGI2NTU2NjBiQQ=="],[99,"aFE2NTU2NjZGbQ=="],[90,"ZUQ2NTU2NjNqQg=="],[28,"U0g2NTU3MjhQZw=="],[111,"RXM2NTU2NTVxVg=="],[54,"UmE2NTU3MTVZTQ=="],[103,"WEk2NTU2NjF5cQ=="],[121,"WWQ2NTU2NTlhbA=="],[117,"V2M2NTU2NjJYZg=="],[85,"cWQ2NTU3MDd1WQ=="],[24,"UEw2NTU3MTlpVQ=="],[66,"bVM2NTU3MjFDVg=="],[107,"QWY2NTU2NjBiSw=="],[64,"YmQ2NTU2NzNsYg=="],[147,"QXo2NTU2NTZUWQ=="],[71,"emY2NTU2NjRxag=="],[125,"b0s2NTU2NTVLdg=="],[74,"SlU2NTU2NjRrSA=="],[78,"bGc2NTU2NjBkRg=="],[20,"Uk42NTU3MjZkRw=="],[105,"eWU2NTU3MTBDZA=="],[59,"dFI2NTU2NTZoaQ=="],[13,"RGY2NTU2NTZ2TQ=="],[39,"cFQ2NTU2NjFKbA=="],[146,"Tkg2NTU2NjVhQw=="],[81,"eWY2NTU2NjNjTA=="],[2,"TU42NTU3MjZBRw=="],[6,"YU02NTU2NTdCaA=="],[152,"eWQ2NTU2NTl5Vw=="],[104,"WXk2NTU2NjdJTw=="],[101,"YlE2NTU3MTFQZQ=="],[58,"UE02NTU3MzB1ag=="],[113,"RGI2NTU3MTBCbw=="],[10,"Z1Q2NTU3MTdpcg=="],[80,"UHE2NTU2NTlScg=="],[86,"a0k2NTU2NThPUA=="],[138,"Ylk2NTU3MjJoaA=="],[118,"VHU2NTU2NjROQg=="],[70,"b3g2NTU2NzFzSw=="],[100,"c1I2NTU2NjVqTg=="],[144,"SU02NTU2NTlMbg=="],[150,"TVU2NTU2NjBsWA=="],[94,"YmE2NTU2NjVXTg=="],[30,"UUQ2NTU3MTRudA=="],[108,"WVk2NTU2NjVySw=="],[25,"VkE2NTU3MjVEVg=="],[132,"S1I2NTU2NjdLTg=="],[112,"WEE2NTU2NjZUZg=="],[141,"WWM2NTU2NjdoUw=="],[116,"RU02NTU2NjVGdw=="],[5,"ZlY2NTU2NjhCeQ=="],[88,"Vkg2NTU3MTBBVA=="],[17,"dEo2NTU3MDl1eQ=="],[124,"Z2c2NTU2NjJBUw=="],[84,"VFE2NTU2NTltSg=="],[126,"QXI2NTU2NTl3ag=="],[89,"RFg2NTU3MDlUVQ=="],[96,"Umo2NTU3MDdSSQ=="],[154,"QWw2NTU2Njd5ZQ=="],[65,"eUE2NTU3MjZ2UA=="],[51,"WkI2NTU3MjBUTQ=="],[27,"WEs2NTU3MTVJUQ=="],[82,"T3Q2NTU2NThFaw=="],[12,"b3I2NTU3MjF5ag=="],[19,"aXI2NTU3MjVzVQ=="],[76,"Q2M2NTU3MDd4ZQ=="],[35,"T202NTU3MTlrRw=="],[4,"SFU2NTU3MjVrbw=="],[22,"WEo2NTU3MTFySg=="],[134,"dUM2NTU2NThndw=="],[46,"SmY2NTU3MThEbA=="],[32,"Uko2NTU2NTZEUw=="],[38,"VlA2NTU2NjJJQg=="],[127,"b3A2NTU2NjVSRA=="],[18,"eU82NTU3MTdISQ=="],[87,"QmI2NTU2NjVrZw=="],[0,"c3g2NTU3MTRmSw=="],[42,"UHA2NTU3MThJbg=="],[119,"VFk2NTU2NjV5Qg=="],[136,"TVQ2NTU2NDhCcg=="],[153,"d0M2NTU2NjJoVg=="],[43,"dU82NTU3MjFGTw=="],[140,"eFc2NTU2NTlnTw=="],[115,"Y082NTU2NTlyUg=="],[63,"UnM2NTU2NjZ1RQ=="],[91,"R2g2NTU3MDlQcw=="],[151,"RlE2NTU2NTZvUA=="],[129,"dlQ2NTU2NjR3Ug=="],[131,"d2w2NTU2NjFUYQ=="],[130,"c0M2NTU2NjVieg=="],[73,"cUw2NTU2NjNPeA=="],[137,"T2E2NTU3MTVCcQ=="],[57,"Rkc2NTU3MTFCVg=="],[75,"bGY2NTU2NjZtVA=="],[143,"VHc2NTU2NTZpTA=="],[16,"WlI2NTU3MDd0dw=="],[97,"eVA2NTU2NjRPZw=="],[49,"U282NTU3MjV4Sg=="],[142,"WmQ2NTU2NTlFcg=="],[21,"RWw2NTU3MjRWRw=="],[15,"QmQ2NTU3MjRMUQ=="],[11,"ckI2NTU3MTVIVg=="],[83,"UHU2NTU2NjZCZA=="],[7,"c3U2NTU2NTdGcw=="],[62,"V2c2NTU3MjdmeQ=="],[61,"eng2NTU2NjFsVw=="],[26,"VUg2NTU3MThaUA=="],[41,"U2I2NTU3MTNVdg=="],[110,"WXE2NTU2NThXaw=="],[40,"UVk2NTU2NTdLWA=="],[148,"VUU2NTU2NjBLbQ=="],[68,"c2s2NTU3MTFUUA=="],[102,"d1Y2NTU3MDlmVw=="],[14,"TGw2NTU3MDlTYg=="],[1,"eHM2NTU3MjZJVA=="],[29,"QWs2NTU3MTFsZw=="],[72,"dGk2NTU3MTB3cw=="],[9,"VHg2NTU3MjFpaA=="],[56,"Wlc2NTU3MTBncw=="],[37,"bWI2NTU2NjJ1Rg=="],[48,"YUg2NTU3MTFIWA=="],[109,"VG02NTU2NjNkaQ=="],[3,"Z1g2NTU3MjJZVA=="],[149,"aUE2NTU2NjJUbw=="],[60,"ZHI2NTU3MTliRg=="],[34,"RHM2NTU3MjFiVQ=="],[106,"Wlk2NTU3MDdKTA=="],[93,"bUg2NTU3MDlDSg=="],[55,"ekY2NTU3MjBKUQ=="],[77,"VXM2NTU2NjNDZA=="],[8,"R1E2NTU3MjZDeQ=="],[123,"aGE2NTU2NThBYw=="],[23,"Qm02NTU3MDdGVQ=="],[53,"dVg2NTU2NTdwbw=="],[44,"UHA2NTU3MDhMZA=="],[139,"aXU2NTU2NzFLTw=="],[92,"bEg2NTU3MTB6bw=="],[52,"SEM2NTU2NjNPeQ=="],[122,"R3o2NTU2NjdydA=="],[50,"U1g2NTU3MjJSVA=="],[114,"bGE2NTU2NTVIYw=="],[133,"U2w2NTU2NjNSbg=="],[33,"bmc2NTU3MDl0bg=="],[95,"TVc2NTU2NjZaVQ=="],[45,"TkE2NTU3MDdRYw=="],[120,"Rm02NTU2NjVrUg=="],[47,"Wkk2NTU2NTdvbg=="],[135,"RGI2NTU2NjJ3Vw=="],[128,"Vkw2NTU2NjJhSg=="],[98,"YkM2NTU2NjVDdA=="],[69,"Z2M2NTU3MjBJVw=="],[31,"elg2NTU3MTB0Rg=="]]; // pega aquí tu arreglo completo Uc
    Uc.sort((a, b) => a[0] - b[0]);

    var k = 60489 + 595121; // Clave correcta
    Uc.forEach(e => {
      let v = e[1];
      playbackURL += String.fromCharCode(parseInt(atob(v).replace(/\D/g, '')) - k);
    });

    var currentPlayer = null;
    var intentosFallidos = 0;

    function iniciarPlayer() {
      const p2pConfig = { trackerZone: 'us', sourceUrl: playbackURL };
      P2PEngineHls.tryRegisterServiceWorker(p2pConfig).then(() => {
        if (currentPlayer) currentPlayer.destroy();
        currentPlayer = new Clappr.Player({
          source: playbackURL,
          parentId: "#player",
          plugins: [SwarmCloudClapprPlugin],
          width: "100%",
          height: "100%",
          autoPlay: true,
          mute: false,
          playsinline: true,
          playback: {
            hlsjsConfig: {
              maxBufferSize: 0,
              maxBufferLength: 12,
              liveSyncDurationCount: 3,
              p2pConfig: p2pConfig
            }
          }
        });
        window.player = currentPlayer;
      });
    }

    function verificarReproduccion() {
      setInterval(() => {
        if (!currentPlayer) return;
        const state = currentPlayer.getPlayback()?.getState?.();
        console.log("Estado:", state);
        if (state === "IDLE" || state === "ERROR" || state === "STOPPED") {
          intentosFallidos++;
          console.warn("Reintentando... intento", intentosFallidos);
          if (intentosFallidos >= 3) {
            console.error("Recargando página...");
            location.reload();
          } else {
            iniciarPlayer();
          }
        }
      }, 30000); // cada 30 segundos
    }

    iniciarPlayer();
    verificarReproduccion();
  </script>
</body>
</html>
